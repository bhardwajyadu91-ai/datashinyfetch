[{"name": "app.py", "content": "from shiny import reactive\nfrom shiny.express import input, render, ui\n\nimport pandas as pd\nimport json\nimport urllib.request\n\n# 1. Page Configuration\nui.page_opts(title=\"Live Google Sheets Dashboard\", fillable=True)\n\n# \ud83d\udd17 Apps Script Web App URL\nURL = \"https://script.google.com/macros/s/AKfycbx3bEAax6SED8WnYwx8GifuxeVJs2Q-5ZlinMQ4smzFzLtqdtYhg9eiXUqXpyLoVBoNXw/exec\"\n\n# 2. Logic (Reactive Calculations)\n@reactive.calc\ndef data():\n    try:\n        # Note: In Shinylive, urllib works well for simple JSON fetches\n        with urllib.request.urlopen(URL) as r:\n            json_data = json.loads(r.read().decode())\n        return pd.DataFrame(json_data)\n    except Exception as e:\n        return pd.DataFrame({\"ERROR\": [str(e)]})\n\n# 3. UI Layout\nui.h2(\"Live Google Sheets Dashboard\")\n\n# Status Bar\nwith ui.div(style=\"padding:10px; background:#f8f9fa; border-radius:6px; margin-bottom: 20px;\"):\n    @render.text\n    def status():\n        return \"\u2705 Connected via Apps Script\" if \"ERROR\" not in data().columns else \"\u274c Failed to load\"\n\n# Value Box for Count\nwith ui.value_box(theme=\"primary\"):\n    \"Total Records\"\n    ui.br()\n    ui.br()\n    \n    @render.text\n    def count():\n        df = data()\n        return str(len(df)) if \"ERROR\" not in df.columns else \"0\"\n\n# Main Data Table\nwith ui.card():\n    @render.data_frame\n    def table():\n        return render.DataTable(data())", "type": "text"}]